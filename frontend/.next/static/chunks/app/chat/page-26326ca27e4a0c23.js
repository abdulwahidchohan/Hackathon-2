(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[457],{63:(e,t,n)=>{"use strict";var o=n(7260);n.o(o,"useRouter")&&n.d(t,{useRouter:function(){return o.useRouter}})},883:(e,t,n)=>{"use strict";n.d(t,{Hh:()=>s,Jv:()=>a,gf:()=>l,yK:()=>o});let o=(0,n(7027).M)({baseURL:"https://hackathon-2-todo-pi.vercel.app"}),{signIn:a,signOut:r,signUp:s,useSession:i}=o;async function l(){var e,t;let{data:n}=await o.getSession();return null!=(t=null==n||null==(e=n.session)?void 0:e.token)?t:null}},4649:(e,t,n)=>{Promise.resolve().then(n.bind(n,6245))},6245:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var o=n(5155),a=n(2115),r=n(2619),s=n.n(r),i=n(63),l=n(883),c=n(7621);function d(){let e=(0,i.useRouter)(),[t,n]=(0,a.useState)(null),[r,d]=(0,a.useState)([]),[u,h]=(0,a.useState)(""),[m,p]=(0,a.useState)(!1),[f,g]=(0,a.useState)(null),[y,x]=(0,a.useState)(""),v=(0,a.useRef)(null);async function w(e){if(e.preventDefault(),!(null==t?void 0:t.id)||!u.trim()||m)return;let n=u.trim();h(""),d(e=>[...e,{role:"user",content:n}]),p(!0),x("");try{let e=await (0,c.gJ)(t.id,n,f);g(e.conversation_id),d(t=>[...t,{role:"assistant",content:e.response}])}catch(e){x(e instanceof Error?e.message:"Send failed"),d(e=>e.slice(0,-1)),h(n)}finally{p(!1)}}return((0,a.useEffect)(()=>{(async()=>{let{data:t}=await l.yK.getSession();if(!(null==t?void 0:t.user))return e.replace("/login");n(t.user)})()},[e]),(0,a.useEffect)(()=>{var e;null==(e=v.current)||e.scrollIntoView({behavior:"smooth"})},[r]),t)?(0,o.jsxs)("main",{style:{maxWidth:640,margin:"0 auto",padding:"1rem",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[(0,o.jsxs)("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,o.jsx)("h1",{children:"Todo Chat"}),(0,o.jsxs)("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[(0,o.jsx)(s(),{href:"/dashboard",children:"Tasks"}),(0,o.jsx)("button",{type:"button",className:"secondary",onClick:async()=>{await l.yK.signOut(),e.push("/login")},children:"Sign out"})]})]}),(0,o.jsx)("p",{style:{fontSize:"0.875rem",color:"#666",marginBottom:"1rem"},children:'Ask in plain language: "Add a task to buy groceries", "Show my tasks", "Mark task 3 complete", etc.'}),(0,o.jsxs)("div",{style:{flex:1,overflow:"auto",marginBottom:"1rem"},children:[0===r.length&&(0,o.jsx)("p",{style:{color:"#888"},children:'No messages yet. Say something like "Show me all my tasks" or "Add a task: call mom".'}),r.map((e,t)=>(0,o.jsxs)("div",{style:{marginBottom:"0.75rem",padding:"0.75rem 1rem",borderRadius:8,backgroundColor:"user"===e.role?"#eff6ff":"#f3f4f6",marginLeft:"user"===e.role?"2rem":0,marginRight:"assistant"===e.role?"2rem":0},children:[(0,o.jsx)("strong",{style:{fontSize:"0.75rem",color:"#666"},children:"user"===e.role?"You":"Assistant"}),(0,o.jsx)("div",{style:{marginTop:"0.25rem",whiteSpace:"pre-wrap"},children:e.content})]},t)),m&&(0,o.jsx)("div",{style:{padding:"0.75rem",color:"#666"},children:"Thinking…"}),(0,o.jsx)("div",{ref:v})]}),y&&(0,o.jsx)("p",{style:{color:"#dc2626",fontSize:"0.875rem",marginBottom:"0.5rem"},children:y}),(0,o.jsxs)("form",{onSubmit:w,style:{display:"flex",gap:"0.5rem"},children:[(0,o.jsx)("input",{placeholder:"Type a message…",value:u,onChange:e=>h(e.target.value),disabled:m,style:{flex:1}}),(0,o.jsx)("button",{type:"submit",disabled:m||!u.trim(),children:"Send"})]})]}):(0,o.jsx)("p",{style:{padding:"2rem"},children:"Loading…"})}},7621:(e,t,n)=>{"use strict";n.d(t,{UT:()=>s,gJ:()=>d,lC:()=>i,q5:()=>c,vq:()=>l,x1:()=>r});var o=n(883);async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=await (0,o.gf)(),a=new Headers(t.headers);return n&&a.set("Authorization","Bearer ".concat(n)),fetch("".concat("http://localhost:8000").concat(e),{...t,headers:a})}async function r(e){let t=await a("/api/".concat(encodeURIComponent(e),"/tasks"));if(!t.ok)throw Error(await t.text());return t.json()}async function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"medium",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=await a("/api/".concat(encodeURIComponent(e),"/tasks"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,description:n,priority:o,tags:r,due_date:s,recurring_rule:i})});if(!l.ok)throw Error(await l.text());return l.json()}async function i(e,t,n){let o=await a("/api/".concat(encodeURIComponent(e),"/tasks/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!o.ok)throw Error(await o.text());return o.json()}async function l(e,t){let n=await a("/api/".concat(encodeURIComponent(e),"/tasks/").concat(t),{method:"DELETE"});if(!n.ok)throw Error(await n.text());return n.json()}async function c(e,t){let n=await a("/api/".concat(encodeURIComponent(e),"/tasks/").concat(t,"/complete"),{method:"PATCH"});if(!n.ok)throw Error(await n.text());return n.json()}async function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=await a("/api/".concat(encodeURIComponent(e),"/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t,conversation_id:n})});if(!o.ok)throw Error(await o.text());return o.json()}}},e=>{e.O(0,[49,441,255,358],()=>e(e.s=4649)),_N_E=e.O()}]);