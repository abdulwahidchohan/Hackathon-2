(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{44:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(5155),n=a(2115),r=a(2619),l=a.n(r),i=a(63),o=a(883),d=a(7621);function c(e){let{initialTask:t,onSubmit:a,onCancel:r}=e,[l,i]=(0,n.useState)((null==t?void 0:t.title)||""),[o,d]=(0,n.useState)((null==t?void 0:t.description)||""),[c,u]=(0,n.useState)((null==t?void 0:t.priority)||"medium"),[x,m]=(0,n.useState)((null==t?void 0:t.tags)||""),[h,p]=(0,n.useState)(""),[g,f]=(0,n.useState)((null==t?void 0:t.recurring_rule)||""),[b,y]=(0,n.useState)(!1),[v,j]=(0,n.useState)("");async function N(e){e.preventDefault(),y(!0),j("");try{await a({title:l,description:o,priority:c,tags:x.trim()||null,due_date:h?new Date(h).toISOString():null,recurring_rule:g||null})}catch(e){j(e instanceof Error?e.message:"Failed to save task"),y(!1)}}return(0,n.useEffect)(()=>{if(null==t?void 0:t.due_date){let e=new Date(t.due_date);e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),p(e.toISOString().slice(0,16))}else p("")},[t]),(0,s.jsxs)("form",{onSubmit:N,className:"flex flex-col gap-4 p-4 border rounded-lg bg-white shadow-sm",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:t?"Edit Task":"New Task"}),v&&(0,s.jsx)("p",{className:"text-red-600 text-sm",children:v}),(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Title *"}),(0,s.jsx)("input",{required:!0,value:l,onChange:e=>i(e.target.value),className:"border p-2 rounded",placeholder:"Buy groceries"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Description"}),(0,s.jsx)("textarea",{value:o,onChange:e=>d(e.target.value),className:"border p-2 rounded",placeholder:"Details...",rows:3})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Priority"}),(0,s.jsxs)("select",{value:c,onChange:e=>u(e.target.value),className:"border p-2 rounded",children:[(0,s.jsx)("option",{value:"low",children:"Low"}),(0,s.jsx)("option",{value:"medium",children:"Medium"}),(0,s.jsx)("option",{value:"high",children:"High"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Recurring"}),(0,s.jsxs)("select",{value:g,onChange:e=>f(e.target.value),className:"border p-2 rounded",children:[(0,s.jsx)("option",{value:"",children:"None"}),(0,s.jsx)("option",{value:"daily",children:"Daily"}),(0,s.jsx)("option",{value:"weekly",children:"Weekly"}),(0,s.jsx)("option",{value:"monthly",children:"Monthly"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Due Date"}),(0,s.jsx)("input",{type:"datetime-local",value:h,onChange:e=>p(e.target.value),className:"border p-2 rounded"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Tags (comma separated)"}),(0,s.jsx)("input",{value:x,onChange:e=>m(e.target.value),className:"border p-2 rounded",placeholder:"work, urgent"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,s.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded hover:bg-gray-200",disabled:b,children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-600 rounded hover:bg-blue-700 disabled:opacity-50",disabled:b,children:b?"Saving...":"Save Task"})]})]})}function u(){let e=(0,i.useRouter)(),[t,a]=(0,n.useState)(null),[r,u]=(0,n.useState)([]),[x,m]=(0,n.useState)(!0),[h,p]=(0,n.useState)(""),[g,f]=(0,n.useState)(!1),[b,y]=(0,n.useState)(null);async function v(){if(null==t?void 0:t.id){m(!0);try{let e=await (0,d.x1)(t.id);u(e)}catch(e){p(e instanceof Error?e.message:"Failed to load tasks")}finally{m(!1)}}}async function j(e){if(null==t?void 0:t.id)try{if(b){let a=await (0,d.lC)(t.id,b.id,e);u(e=>e.map(e=>e.id===b.id?a:e))}else{let a=await (0,d.UT)(t.id,e.title,e.description,e.priority,e.tags,e.due_date,e.recurring_rule);u(e=>[...e,a])}f(!1),y(null)}catch(e){p(e instanceof Error?e.message:"Operation failed")}}async function N(e){if((null==t?void 0:t.id)&&confirm("Are you sure?"))try{await (0,d.vq)(t.id,e),u(t=>t.filter(t=>t.id!==e))}catch(e){p(e instanceof Error?e.message:"Failed to delete")}}async function w(e){if(null==t?void 0:t.id)try{let a=await (0,d.q5)(t.id,e);u(t=>t.map(t=>t.id===e?a:t)),a.recurring_rule&&a.completed&&v()}catch(e){p(e instanceof Error?e.message:"Failed to update")}}function k(){y(null),f(!0)}return(0,n.useEffect)(()=>{(async()=>{let{data:t}=await o.yK.getSession();if(!(null==t?void 0:t.user))return e.replace("/login");a(t.user)})()},[e]),(0,n.useEffect)(()=>{(null==t?void 0:t.id)&&v()},[null==t?void 0:t.id]),t?(0,s.jsxs)("main",{className:"max-w-3xl mx-auto p-4 min-h-screen",children:[(0,s.jsxs)("header",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Tasks"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Welcome, ",t.email||t.id]})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(l(),{href:"/chat",className:"px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-md transition-colors",children:"Chat with AI"}),(0,s.jsx)("button",{onClick:k,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors shadow-sm",children:"+ New Task"}),(0,s.jsx)("button",{onClick:async()=>{await o.yK.signOut(),e.push("/login")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border hover:bg-gray-50 rounded-md transition-colors",children:"Sign out"})]})]}),h&&(0,s.jsx)("div",{className:"mb-4 p-4 text-red-700 bg-red-100 rounded-md border border-red-200",children:h}),g&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,s.jsx)("div",{className:"w-full max-w-lg",children:(0,s.jsx)(c,{initialTask:b,onSubmit:j,onCancel:()=>{f(!1),y(null)}})})}),x&&!r.length?(0,s.jsx)("div",{className:"text-center py-12 text-gray-500",children:"Loading tasks..."}):0===r.length?(0,s.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:[(0,s.jsx)("p",{className:"text-gray-500 mb-2",children:"No tasks found."}),(0,s.jsx)("button",{onClick:k,className:"text-blue-600 hover:underline",children:"Create your first task"})]}):(0,s.jsx)("div",{className:"space-y-3",children:r.map(e=>(0,s.jsxs)("div",{className:"group flex items-start gap-3 p-4 bg-white border rounded-lg shadow-sm hover:shadow-md transition-shadow ".concat(e.completed?"opacity-75 bg-gray-50":""),children:[(0,s.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>w(e.id),className:"mt-1.5 h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 ".concat(e.completed?"line-through text-gray-500":""),children:e.title}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mt-1",children:[(0,s.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full border uppercase ".concat(function(e){switch(e){case"high":return"text-red-600 bg-red-50 border-red-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}}(e.priority)),children:e.priority}),e.recurring_rule&&(0,s.jsxs)("span",{className:"px-2 py-0.5 text-xs font-medium text-purple-600 bg-purple-50 border border-purple-200 rounded-full flex items-center gap-1",children:["â†» ",e.recurring_rule]}),e.due_date&&(0,s.jsxs)("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full border ".concat(new Date(e.due_date)<new Date&&!e.completed?"text-red-700 bg-red-50 border-red-200":"text-gray-600 bg-gray-50 border-gray-200"),children:["\uD83D\uDCC5 ",new Date(e.due_date).toLocaleDateString()]}),e.tags&&e.tags.split(",").map(e=>(0,s.jsxs)("span",{className:"px-2 py-0.5 text-xs text-blue-700 bg-blue-50 border border-blue-100 rounded-full",children:["#",e.trim()]},e))]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,s.jsx)("button",{onClick:()=>{y(e),f(!0)},className:"p-1 px-2 text-xs text-gray-600 hover:bg-gray-100 rounded",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>N(e.id),className:"p-1 px-2 text-xs text-red-600 hover:bg-red-50 rounded",children:"Delete"})]})]}),e.description&&(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600 ".concat(e.completed?"line-through":""),children:e.description})]})]},e.id))})]}):(0,s.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Loading..."})}},63:(e,t,a)=>{"use strict";var s=a(7260);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},883:(e,t,a)=>{"use strict";a.d(t,{Hh:()=>l,Jv:()=>n,gf:()=>o,yK:()=>s});let s=(0,a(7027).M)({baseURL:"https://hackathon-2-todo-pi.vercel.app"}),{signIn:n,signOut:r,signUp:l,useSession:i}=s;async function o(){var e,t;let{data:a}=await s.getSession();return null!=(t=null==a||null==(e=a.session)?void 0:e.token)?t:null}},1751:(e,t,a)=>{Promise.resolve().then(a.bind(a,44))},7621:(e,t,a)=>{"use strict";a.d(t,{UT:()=>l,gJ:()=>c,lC:()=>i,q5:()=>d,vq:()=>o,x1:()=>r});var s=a(883);async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await (0,s.gf)(),n=new Headers(t.headers);return a&&n.set("Authorization","Bearer ".concat(a)),fetch("".concat("http://localhost:8000").concat(e),{...t,headers:n})}async function r(e){let t=await n("/api/".concat(encodeURIComponent(e),"/tasks"));if(!t.ok)throw Error(await t.text());return t.json()}async function l(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"medium",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=await n("/api/".concat(encodeURIComponent(e),"/tasks"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,description:a,priority:s,tags:r,due_date:l,recurring_rule:i})});if(!o.ok)throw Error(await o.text());return o.json()}async function i(e,t,a){let s=await n("/api/".concat(encodeURIComponent(e),"/tasks/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok)throw Error(await s.text());return s.json()}async function o(e,t){let a=await n("/api/".concat(encodeURIComponent(e),"/tasks/").concat(t),{method:"DELETE"});if(!a.ok)throw Error(await a.text());return a.json()}async function d(e,t){let a=await n("/api/".concat(encodeURIComponent(e),"/tasks/").concat(t,"/complete"),{method:"PATCH"});if(!a.ok)throw Error(await a.text());return a.json()}async function c(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=await n("/api/".concat(encodeURIComponent(e),"/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t,conversation_id:a})});if(!s.ok)throw Error(await s.text());return s.json()}}},e=>{e.O(0,[49,441,255,358],()=>e(e.s=1751)),_N_E=e.O()}]);